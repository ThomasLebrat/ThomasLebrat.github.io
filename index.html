<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-02-28 mar. 11:45 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Structure Thermique de l'atmopshère</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Thomas Lebrat" />
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/bigblow_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/bigblow_theme/css/bigblow.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/bigblow_theme/css/hideshow.css"/>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/bigblow_theme/js/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/bigblow_theme/js/jquery-ui-1.10.2.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/bigblow_theme/js/jquery.localscroll-min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/bigblow_theme/js/jquery.scrollTo-1.4.3.1-min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/bigblow_theme/js/jquery.zclip.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/bigblow_theme/js/bigblow.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/bigblow_theme/js/hideshow.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Structure Thermique de l'atmopshère</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org34ac708">1. Introduction</a>
<ul>
<li><a href="#org6003117">1.1. Objectifs de l'activité et compétences travaillées</a></li>
<li><a href="#orgbdd270d">1.2. Documentation et remerciements</a>
<ul>
<li><a href="#orgdfb1880"><span class="todo TODO">TODO</span> nommenclature et origine des noms des couches</a></li>
<li><a href="#orga296466"><span class="todo TODO">TODO</span> biblio</a></li>
</ul>
</li>
<li><a href="#org50cfa33">1.3. Tableau commenté</a></li>
</ul>
</li>
<li><a href="#org1f4b864">2. TP Sondage Atmosphérique - [ correction ]</a>
<ul>
<li><a href="#orgc80392c">Préparatifs</a></li>
<li><a href="#org8fc7f9d">Q.01 - écriture de la formule d'interpolation -&#xa0;&#xa0;&#xa0;<span class="tag"><span class="TABLEAU">TABLEAU</span>&#xa0;<span class="EXAM">EXAM</span></span></a></li>
<li><a href="#org4939766">Q.02 - écriture de la fonction d'interpolation de température -&#xa0;&#xa0;&#xa0;<span class="tag"><span class="CODE">CODE</span>&#xa0;<span class="EXAM">EXAM</span></span></a></li>
<li><a href="#org5674fb6">Q.03 - remplissage des tableaux zatm et Tatm -&#xa0;&#xa0;&#xa0;<span class="tag"><span class="CODE">CODE</span></span></a></li>
<li><a href="#org1e11b6d">Q.04 - tracé du profil de température de l'atmosphère -&#xa0;&#xa0;&#xa0;<span class="tag"><span class="CODE">CODE</span></span></a>
<ul>
<li><a href="#orge1448bd"><span class="todo TODO">TODO</span> petit plus</a></li>
</ul>
</li>
<li><a href="#orgf560b77">Q.05 - masse volumique&#xa0;&#xa0;&#xa0;<span class="tag"><span class="TABLEAU">TABLEAU</span>&#xa0;<span class="EXAM">EXAM</span></span></a></li>
<li><a href="#orgf5a080a">Q.06 - équation différentielle du champ de pression&#xa0;&#xa0;&#xa0;<span class="tag"><span class="TABLEAU">TABLEAU</span>&#xa0;<span class="EXAM">EXAM</span></span></a></li>
<li><a href="#orge463fc5">Q.07</a></li>
<li><a href="#org5cb740e">Q.08 - calcul de la masse totale de l'atmosphère&#xa0;&#xa0;&#xa0;<span class="tag"><span class="CODE">CODE</span></span></a></li>
<li><a href="#org09374c8">Q.09&#xa0;&#xa0;&#xa0;<span class="tag"><span class="TABLEAU">TABLEAU</span></span></a></li>
<li><a href="#orge0971b4">Q.10&#xa0;&#xa0;&#xa0;<span class="tag"><span class="CODE">CODE</span></span></a></li>
<li><a href="#org59cd630">Q.11&#xa0;&#xa0;&#xa0;<span class="tag"><span class="TABLEAU">TABLEAU</span></span></a></li>
<li><a href="#org618a61a">Q.12&#xa0;&#xa0;&#xa0;<span class="tag"><span class="CODE">CODE</span></span></a></li>
</ul>
</li>
<li><a href="#orgedef26b">3. Exercice Formation d'un nuage - [ optionnel ]&#xa0;&#xa0;&#xa0;<span class="tag"><span class="BONUS">BONUS</span></span></a>
<ul>
<li><a href="#orgce20ae1">3.1. En l'abscence de mouvement (équilibre)</a></li>
<li><a href="#org121618d">3.2. Apparition d'un mouvement (instabilté)</a></li>
<li><a href="#orgaeb8859">3.3. Explication qualitative de la formation d'un nuage.</a></li>
</ul>
</li>
</ul>
</div>
</div>


<div id="outline-container-org34ac708" class="outline-2">
<h2 id="org34ac708"><span class="section-number-2">1</span> Introduction</h2>
<div class="outline-text-2" id="text-1">
<p>
Un ballon-sonde mesure les caractéristiques de l'atmosphère à l'aide d'instruments embarqués. Les données obtenues en fonction de l'altitude sont renvoyées au sol par signal radio. L'importance de ces données <i>in situ</i> est cruciale pour affiner les modèles physiques de l'atmosphère utilisés en météorologie et notamment <i>calibrer</i> les mesures réalisées par satellite à des fin de télédétection.
</p>

<p>
Les altitudes maximales atteintes sont variables : cela dépend des modèles, en particulier si le ballon est ouvert ou fermé. On retient  une valeur approchée de \(50~km\) pour cette altitude plafond. Cet ordre de grandeur est-il bien réaliste ? Pourquoi une telle limite : quels sont les mécanismes physiques qui contrôlent le déclenchement et la statbilisation de l'ascension ?
</p>
</div>



<div id="outline-container-org6003117" class="outline-3">
<h3 id="org6003117"><span class="section-number-3">1.1</span> Objectifs de l'activité et compétences travaillées</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Nous fournissons une vingtaine de valeurs de température. Ces données ont été analysées lors de la premimère séance (voir le tableau commenté en section suivante).
</p>

<p>
Les questions Q1 à Q12 vous guident pour atteindre les 3 ojectifs principaux de cette activité : 
</p>

<ol class="org-ol">
<li>Construire des profils verticaux \(\rightarrow\) identifier les couches atmosphériques</li>
<li>Déterminer un profil de pression \(\looparrowright\) 100 km tenant compte de \(\Delta T\)</li>
<li>Discuter la pertinence du choix de certaines hypothèses (iso-g, iso-T)</li>
</ol>

<p>
Une participation active et constructive est toujours bienvenue et valorisée. Vous êtes autorisés (et encouragés !) à nous solliciter pour nous soumettre vos questions scientifiques (ex: <i>Mais c'est quoi un gradient adiabatique ?</i>) ou techniques (ex: <i>Comment faire converger mon algorithme efficacement ?</i>). 
</p>

<p>
Voici une liste des compétences travaillées dans ce TP : 
</p>

<ul class="org-ul">
<li>Implémenter des méthodes numériques simples : <b>interpolation</b> et <b>intégration</b></li>
<li>Comprendre le principe de la <b>régression</b>, technique fondamentale pour les méthodes de sondage</li>
<li>Explorer quelques possibités du language <code>Python</code> + <code>numpy</code></li>
</ul>

<p>
Remarque : avec l'utilisation de <code>Matplotlib</code> la syntaxe est assez proche de <code>MATLAB</code>
</p>

<p>
Accéssoirement, vous pourrez utiliser des librairies spécialisées telles que <code>scipy</code>, <code>pandas</code>, <code>plotly</code> (&#x2026;) et d'autres outils que vous aimeriez partager s'il permettent de gagner du temps de développement ou du temps de calcul.
</p>
</div>
</div>



<div id="outline-container-orgbdd270d" class="outline-3">
<h3 id="orgbdd270d"><span class="section-number-3">1.2</span> Documentation et remerciements</h3>
<div class="outline-text-3" id="text-1-2">
</div>
<div id="outline-container-orgdfb1880" class="outline-4">
<h4 id="orgdfb1880"><span class="todo TODO">TODO</span> nommenclature et origine des noms des couches</h4>
<div class="outline-text-4" id="text-orgdfb1880">
</div>
</div>




<div id="outline-container-orga296466" class="outline-4">
<h4 id="orga296466"><span class="todo TODO">TODO</span> biblio</h4>
<div class="outline-text-4" id="text-orga296466">
<p>
Cette activité est inspirée des documents suivants (liste à compléter)
</p>

<ul class="org-ul">
<li><a href="https://labolycee.org/mecanique-du-vol-dun-ballon-sonde">Exo Bac</a></li>
<li><a href="http://www.msc.univ-paris-diderot.fr/~phyexp/pmwiki.php/Convention/ConvectionEtPanacheThermique">Images de panaches thermiques (UP7)</a></li>
<li><a href="https://web.archive.org/web/20081119164748/http://www.meteofrance.com/FR/glossaire/designation/693_initie_view.jsp">Glossaire Meteo France</a></li>
<li><a href="http://b.louchart.free.fr/Concours_et_examens/Centrale_Supelec/Sujets/2008_TSI_Physique_1.html">Sujet Concours TSI 2008</a></li>
<li><a href="https://planet-terre.ens-lyon.fr/ressource/mouvts-enveloppes-fluides2.xml">Site Planète Terre ENS Lyon</a></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org50cfa33" class="outline-3">
<h3 id="org50cfa33"><span class="section-number-3">1.3</span> Tableau commenté</h3>
<div class="outline-text-3" id="text-1-3">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">z(km)</th>
<th scope="col" class="org-right">T(°C)</th>
<th scope="col" class="org-right">T(K)</th>
<th scope="col" class="org-left">T (ASCII Profile)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">100</td>
<td class="org-right">-72</td>
<td class="org-right">201</td>
<td class="org-left">▉▉▋</td>
</tr>

<tr>
<td class="org-right">95</td>
<td class="org-right">-81</td>
<td class="org-right">192</td>
<td class="org-left">▉▋</td>
</tr>

<tr>
<td class="org-right">92</td>
<td class="org-right">-86</td>
<td class="org-right">187</td>
<td class="org-left">▉▎</td>
</tr>

<tr>
<td class="org-right">84</td>
<td class="org-right">-86</td>
<td class="org-right">187</td>
<td class="org-left">▉▎</td>
</tr>

<tr>
<td class="org-right">80</td>
<td class="org-right">-86</td>
<td class="org-right">187</td>
<td class="org-left">▉▎</td>
</tr>

<tr>
<td class="org-right">75</td>
<td class="org-right">-79</td>
<td class="org-right">194</td>
<td class="org-left">▉▉</td>
</tr>

<tr>
<td class="org-right">70</td>
<td class="org-right">-65</td>
<td class="org-right">208</td>
<td class="org-left">▉▉▉▍</td>
</tr>

<tr>
<td class="org-right">65</td>
<td class="org-right">-54</td>
<td class="org-right">219</td>
<td class="org-left">▉▉▉▉▌</td>
</tr>

<tr>
<td class="org-right">60</td>
<td class="org-right">-33</td>
<td class="org-right">240</td>
<td class="org-left">▉▉▉▉▉▉▋</td>
</tr>

<tr>
<td class="org-right">55</td>
<td class="org-right">-17</td>
<td class="org-right">256</td>
<td class="org-left">▉▉▉▉▉▉▉▉▍</td>
</tr>

<tr>
<td class="org-right">52</td>
<td class="org-right">-7</td>
<td class="org-right">266</td>
<td class="org-left">▉▉▉▉▉▉▉▉▉▍</td>
</tr>

<tr>
<td class="org-right">48</td>
<td class="org-right">-2</td>
<td class="org-right">271</td>
<td class="org-left">▉▉▉▉▉▉▉▉▉▉</td>
</tr>

<tr>
<td class="org-right">45</td>
<td class="org-right">-2</td>
<td class="org-right">271</td>
<td class="org-left">▉▉▉▉▉▉▉▉▉▉</td>
</tr>

<tr>
<td class="org-right">40</td>
<td class="org-right">-8</td>
<td class="org-right">265</td>
<td class="org-left">▉▉▉▉▉▉▉▉▉▍</td>
</tr>

<tr>
<td class="org-right">35</td>
<td class="org-right">-22</td>
<td class="org-right">251</td>
<td class="org-left">▉▉▉▉▉▉▉▉</td>
</tr>

<tr>
<td class="org-right">30</td>
<td class="org-right">-37</td>
<td class="org-right">236</td>
<td class="org-left">▉▉▉▉▉▉▍</td>
</tr>

<tr>
<td class="org-right">25</td>
<td class="org-right">-46</td>
<td class="org-right">227</td>
<td class="org-left">▉▉▉▉▉▍</td>
</tr>

<tr>
<td class="org-right">20</td>
<td class="org-right">-56</td>
<td class="org-right">217</td>
<td class="org-left">▉▉▉▉▍</td>
</tr>

<tr>
<td class="org-right">12</td>
<td class="org-right">-56</td>
<td class="org-right">217</td>
<td class="org-left">▉▉▉▉▍</td>
</tr>

<tr>
<td class="org-right">10</td>
<td class="org-right">-49</td>
<td class="org-right">224</td>
<td class="org-left">▉▉▉▉▉▏</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-right">-18</td>
<td class="org-right">255</td>
<td class="org-left">▉▉▉▉▉▉▉▉▎</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-right">15</td>
<td class="org-right">288</td>
<td class="org-left">▉▉▉▉▉▉▉▉▉▉▉▊</td>
</tr>
</tbody>
</table>

<p>
On repère les tendances discutées au premmier cours, les creux et les bosses correspondant aux <i>minima</i> et <i>maxima</i> locaux. Des valeurs identiques pourraient indiquer des bandes stationnaires mais l'échantillonage est insuffisant pour trancher.
</p>

<p>
Le tableau de données est saisi à la main puis commenté en groupe : 
</p>

<ul class="org-ul">
<li>&lt;&lt; il fait froid &gt;&gt; : en effet la température \(T\) est  toujours (vraiment ?) négative au delà de 5 km</li>
<li>à l'évidence, \(T\) n'est connue qu'en certaines altitudes, espacées de manière <i>irrégulière</i></li>
<li>depuis le sol, des tendances sont identifiables : \(\searrow\) , \(\nearrow\) , \(\searrow\) , \(\nearrow\)</li>
<li>des mesures font apparaître des valeurs identiques (stagnation ?)</li>
<li>les étudiants se demandent alors si cela ne posera pas de problème numérique (ce point à été traité en détail à l'oral en TP &#x2026;)</li>
</ul>

<p>
Attention, la conversion en Kelvin peut-être source d'erreurs ! Pour nos calculs, on prendra garde à bien vérifier que le zero absolu correspond à une température de \(-273~C\) c-à-d que : 
</p>

<p>
\[T(K) = T(C) + 273 \]
</p>
</div>
</div>
</div>


<div id="outline-container-org1f4b864" class="outline-2">
<h2 id="org1f4b864"><span class="section-number-2">2</span> TP Sondage Atmosphérique - [ correction ]</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orgc80392c" class="outline-3">
<h3 id="orgc80392c">Préparatifs</h3>
<div class="outline-text-3" id="text-orgc80392c">
<ul class="org-ul">
<li>Importer des librairies (on se limite aux lib standards)</li>
<li>Fixer les valeurs des constantes physiques</li>
<li>Attention aux unités \(km\) (non SI) et \(kg\) (SI)</li>
<li>Saisir les tableaux de valeurs de température</li>
<li>Tester collectivement l'execution d'un même bout de code</li>
</ul>


<p>
Ici nous avons fait le choix du mode Python (version 3) édité via Jupyter-Emacs.
</p>



<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np
<span style="color: #0000FF;">import</span> matplotlib
<span style="color: #0000FF;">import</span> matplotlib.pyplot <span style="color: #0000FF;">as</span> plt

<span style="color: #8D8D84;">#</span><span style="color: #8D8D84; font-style: italic;">Constantes</span>
<span style="color: #BA36A5;">pi</span> = np.pi ; <span style="color: #BA36A5;">M</span> = 29.0e-3 ; <span style="color: #BA36A5;">R</span> = 8.31

<span style="color: #BA36A5;">RT</span> = 6.4e3  ; <span style="color: #BA36A5;">RT_m</span> = 6.4e6
<span style="color: #BA36A5;">P0</span> = 1.0e5  ; <span style="color: #BA36A5;">g0</span> = 9.8
<span style="color: #8D8D84;">#</span><span style="color: #8D8D84; font-style: italic;">Cte = </span>

<span style="color: #8D8D84;">#</span><span style="color: #8D8D84; font-style: italic;">Altitude en km</span>
<span style="color: #BA36A5;">zexp</span> = np.array([0.0, 5.0, 10.0, 12.0, 20.0, 25.0, 30.0,35.0, 40.0,
                 45.0, 48.0, 52.0, 55.0, 60.0, 65.0, 70.0, 75.0, 80.0, 84.0, 92.0, 95.0,100.0])

<span style="color: #8D8D84;">#</span><span style="color: #8D8D84; font-style: italic;">Temp&#233;rature en degr&#233;s celcius</span>
<span style="color: #BA36A5;">Texp</span> = np.array([15.0, -18.0, -49.0, -56.0, -56.0, -51.0, -46.0, -37.0,
                 -22.0, -8.0, -2.0, -2.0, -7.0, -17.0, -33.0, -54.0, -65.0, -79.0, -86.0,-86.0, -81.0, -72.0])


</pre>
</div>

<p>
On réalise un premier graphique, ocasion de vérfier la bonne saisie des valeurs : 
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #BA36A5;">fig</span>, <span style="color: #BA36A5;">ax</span> = plt.subplots()
ax.plot( Texp,zexp)
plt.show()
plt.savefig(<span style="color: #008000;">"graph_Q0.png"</span>)
</pre>
</div>


<p>
<b>NB</b> : les lignes de code seront susceptibles d'être remaniées et/ou commentées en fonction de vos retours.
</p>

<p>
Les tags <code>TABLEAU</code> et <code>CODE</code> rappellent lorsque les questions ont été traités "au tableau" en résolvant les équations à la main ou via des scripts (Python ou Matlab) sur les machines. Les tags <code>EXAM</code> signalent les quelques sections qu'il est indispensable de maîtriser pour l'examen.
</p>
</div>
</div>


<div id="outline-container-org8fc7f9d" class="outline-3">
<h3 id="org8fc7f9d">Q.01 - écriture de la formule d'interpolation -&#xa0;&#xa0;&#xa0;<span class="tag"><span class="TABLEAU">TABLEAU</span>&#xa0;<span class="EXAM">EXAM</span></span></h3>
<div class="outline-text-3" id="text-org8fc7f9d">
<p>
Un travail de reformulation de la question est fait avec les étudiants.
</p>

<p>
Considérons un intervalle \(Z_{i}\) = \(\left[ z_{i} ~; z_{i+1} \right]\). On place sur un schéma deux points successifs \(M_{i} \left( z_i,T_i \right)\) et \(M_{i+1} \left ( z_{i+1}, T_{i+1} \right)\). Réaliser une <i>interpolation linéaire</i> revient à : 
</p>

<ul class="org-ul">
<li>déterminer la droite joignant ces deux points (i.e quelle est son équation ?)</li>
<li>générer un ensemble points appartenant à cette droite à l'aider d'un script</li>
</ul>

<p>
Pour guider la résolution, nous avons répondu à l'oral aux questions suivantes:
</p>

<ol class="org-ol">
<li>Que vaut la température correspondant à un point milieu de cet intervalle ?</li>
<li>De combien de paramètres dépend la fonction d'interpolation affine \(T(z)\) sur l'intervalle \(Z_{i}\) ?</li>
<li>Exprimer les paramètres en fonction des données mesurées aux points \(M_{i}(z_i,T_i)\) et \(M_{i+1}(z_{i+1}, T_{i+1})\).</li>
</ol>

<p>
Remarque : Dans ce cas simple, on peut trouver facilement la solution par tatônnements. On pourra sinon poser proprement un système d'équations, avec autant d'équations que d'inconnues (méthode qui s'avérera toujours payante pour les techniques d'interpolation plus sophistiquée).
</p>

<p>
<b>NB</b> (en vue de l'examen) : tous les élèves présents au TP ont réussi à réaliser l'interpolation en Python ou en Matlab/Octabe (temps de réalisation moyen pour un programme sans bug ~1h). Un corrigé a été réalisé au tableau. Il est donc attendu que vous sachiez expliquer simplement le travail réalisé. 
</p>
</div>
</div>


<div id="outline-container-org4939766" class="outline-3">
<h3 id="org4939766">Q.02 - écriture de la fonction d'interpolation de température -&#xa0;&#xa0;&#xa0;<span class="tag"><span class="CODE">CODE</span>&#xa0;<span class="EXAM">EXAM</span></span></h3>
<div class="outline-text-3" id="text-org4939766">
<p>
Partant des mesures d'altitude fournies et en faisant attention au choix des unités (source de nombreuses erreurs), on implémente le bout de code artisanal suivant (nous vous invitons à améliorer son écriture &#x2026;)
</p>


<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">interpolation</span>
<span style="color: #0000FF;">def</span> <span style="color: #006699;">T</span>(z, unite):
    <span style="color: #BA36A5;">z_km</span> = z / 1000 <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Conversion en km pour comparaison dans la liste</span>
    <span style="color: #BA36A5;">alpha</span> = 1 <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Valeur par d&#233;faut pour la conversion en K</span>
    <span style="color: #0000FF;">if</span> unite == <span style="color: #008000;">'C'</span>:
        alpha = 0 <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Pas de d&#233;calage pour la temp&#233;rature en &#176;C</span>
    i = 0
    <span style="color: #0000FF;">while</span> z_km &gt; zexp[i + 1]: <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Recherche de l&#8217;indice i</span>
        i = i + 1
    temperature = alpha*273 + Texp[i] + (z_km - zexp[i])/(zexp[i + 1] - zexp[i])*(Texp[i + 1] - Texp[i]) <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Interpolation lin&#233;aire</span>
    <span style="color: #0000FF;">return</span> temperature
</pre>
</div>
</div>
</div>

<div id="outline-container-org5674fb6" class="outline-3">
<h3 id="org5674fb6">Q.03 - remplissage des tableaux zatm et Tatm -&#xa0;&#xa0;&#xa0;<span class="tag"><span class="CODE">CODE</span></span></h3>
<div class="outline-text-3" id="text-org5674fb6">
<p>
On calcule \(N\) altitudes régulièrement réparties entre 0 et 100 km avec leur températures correspondantes : 
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #BA36A5;">N</span> = 100 <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Nombre de points</span>
<span style="color: #BA36A5;">zmax</span> = 100.0e3 <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Altitude max (en m)</span>
<span style="color: #BA36A5;">dz</span> = zmax/(N-1) <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Pas spatial (en m)</span>

<span style="color: #BA36A5;">zatm</span> = np.array([k*dz <span style="color: #0000FF;">for</span> k <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">range</span>(N)]) <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Altitudes</span>
<span style="color: #BA36A5;">Tatm</span> = np.array([T(zatm[k], <span style="color: #008000;">'K'</span>) <span style="color: #0000FF;">for</span> k <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">range</span>(N)]) <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Temp&#233;ratures</span>

<span style="color: #BA36A5;">TexpC</span> = Texp + 273
<span style="color: #BA36A5;">zexpm</span> = zexp * 1e3
</pre>
</div>
</div>
</div>


<div id="outline-container-org1e11b6d" class="outline-3">
<h3 id="org1e11b6d">Q.04 - tracé du profil de température de l'atmosphère -&#xa0;&#xa0;&#xa0;<span class="tag"><span class="CODE">CODE</span></span></h3>
<div class="outline-text-3" id="text-org1e11b6d">
<p>
On réalise le graphe et on vérifie la justesse de l'interpolation (vert) par l'ajout des points de mesure (rouges).
</p>



<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #BA36A5;">fig</span>, <span style="color: #BA36A5;">ax</span> = plt.subplots()
ax.plot( TexpC,zexpm,<span style="color: #008000;">'ro'</span>)
ax.plot( Tatm,zatm,<span style="color: #008000;">'-g'</span>)
plt.savefig(<span style="color: #008000;">"graph_Q4.png"</span>)
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/19886f271eb3c875f57ce89f1189a6f128fe408a.png" alt="19886f271eb3c875f57ce89f1189a6f128fe408a.png" />
</p>
</div>

<p>
On distingue les différentes couches.
</p>

<p>
Je vous laisse le soin de retrouver les intervalles en z correspondants : 
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">troposphère</th>
<th scope="col" class="org-left">stratosphère</th>
<th scope="col" class="org-left">mesosphère</th>
<th scope="col" class="org-left">thermosphère</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">[ &#x2026; ; &#x2026;]</td>
<td class="org-left">[ &#x2026; ; &#x2026; ]</td>
<td class="org-left">[ &#x2026; ; &#x2026; ]</td>
<td class="org-left">[ &#x2026; ; &#x2026; ]</td>
</tr>
</tbody>
</table>
</div>


<div id="outline-container-orge1448bd" class="outline-4">
<h4 id="orge1448bd"><span class="todo TODO">TODO</span> petit plus</h4>
<div class="outline-text-4" id="text-orge1448bd">
<p>
Un étudiant à réalisé un joli graphe permettant d'identifier les couches.
Il pourrait être ajouté ci après.
</p>
</div>
</div>
</div>





<div id="outline-container-orgf560b77" class="outline-3">
<h3 id="orgf560b77">Q.05 - masse volumique&#xa0;&#xa0;&#xa0;<span class="tag"><span class="TABLEAU">TABLEAU</span>&#xa0;<span class="EXAM">EXAM</span></span></h3>
<div class="outline-text-3" id="text-orgf560b77">
<p>
On a montré en séance que : 
</p>

<p>
\[\rho(z)= \frac{M P(z)}{R T(z)} \] 
</p>

<p>
Question classique, nécéssitant de manipuler <i>l'équation des gaz parfaits</i> couplée aux définitions des <i>masses molaires</i> et <i>masses volumiques</i>.
</p>

<p>
<b>NB</b> : petit topo méthodo
</p>

<ul class="org-ul">
<li>Quelques difficultés à retrouver la formule rapidement ! Pour y remédier, des techniques ont été présentées. Penser qu'on connait par avance "la forme algébrique" du résultat (rapport de produits de parmètres). Cela implique de jouer avec les unités &#x2026;</li>

<li>Cette question vous invite à faire usage de votre bon sens physique :  la masse volumique augmente-t-elle ou diminue-t-elle lorsque la température augmente ? <i>idem</i> en fonction la pression ?</li>

<li>A savoir traiter à l'examen !</li>
</ul>

<p>
Remarque : Dans ce problème, les grandeurs ne sont pas uniformes ! On adopte une description locale de l'atmosphère en utilisant un jeu de variables intensives  \(P\), \(T\) et \(\rho\). Ce sont les inconues du problème. Un traitement rigoureux de cette aspect technique est réalisé dans le manuel de Thermodynamique de Vincent Renvoizé (Ellipses, 2005).
</p>
</div>
</div>


<div id="outline-container-orgf5a080a" class="outline-3">
<h3 id="orgf5a080a">Q.06 - équation différentielle du champ de pression&#xa0;&#xa0;&#xa0;<span class="tag"><span class="TABLEAU">TABLEAU</span>&#xa0;<span class="EXAM">EXAM</span></span></h3>
<div class="outline-text-3" id="text-orgf5a080a">
<p>
Un autre classique, le fameux " Grad de P égal ROGER " (moyen mnémotechnique) : 
</p>

<p>
\[ \vec{\nabla} P = \rho \vec{g}\]
</p>

<p>
On peut s'entrainer à retrouver ce résultat en faisant un petit bilan des forces (pression &amp; gravité) exercées sur une tranche d'air d'épaisseur \(dz\) et de section \(S\) : 
</p>

<p>
On a en dessous, une force de norme 
</p>

<p>
\[ p(z) S \] 
</p>

<p>
Et au dessus, en \(z+dz\) une force de norme dessus 
</p>

<p>
\[ p(z+dz) S \]
</p>

<p>
Le poids a pour intensité \[ \rho (z) ~S~dz~g \] 
</p>

<p>
Il s'applique au centre de gravité et équilibre les forces de pression 
</p>

<p>
\[ p(z+dz) -p(z) = - \rho g  dz \]
</p>

<p>
qui se réécrit, en passant à la limite quand \(dz\) tend vers 0 : \[ dp/dz = -\rho g \] soit en explicitant la masse volumique  \(\rho\) qui elle même dépend de la pression &#x2026;
</p>

<p>
\[ \frac{dP}{dz} + \frac{M g(z)}{R T(z)} p(z) = 0 \]
</p>

<p>
Remarque : cette équation peut se réécrire, en posant \(\zeta = ln(P)\). (utile pour estimer des taux de var)
</p>

<p>
\[ \frac{d\zeta}{dz} = - \frac{M g(z)}{R T(z)} \]
</p>
</div>
</div>


<div id="outline-container-orge463fc5" class="outline-3">
<h3 id="orge463fc5">Q.07</h3>
<div class="outline-text-3" id="text-orge463fc5">
<p>
On intègre l'équation différentielle précédente. Il ne vous aura pas échappé que la température varie avec l'altitude. Il faut donc en toute rigueur en tenir compte et mettre à jour la valeur de \(T\) dans la boucle d'intégration.
</p>

<p>
Même remarque pour le champ de pesanteur qui varie lui aussi avec \(z\) (la démonstration de cette formule a par application du théorème de Gauss a d'ailleurs faite en TD).
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #0000FF;">def</span> <span style="color: #006699;">g1</span>(z): <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Champ de pesanteur</span>
    <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">RT est en km et z est en km</span>
    <span style="color: #0000FF;">return</span> g0 * RT**2 / (RT + z)**2
</pre>
</div>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #0000FF;">def</span> <span style="color: #006699;">g2</span>(z): <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Champ de pesanteur</span>
    <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">RT est en m et z est en m</span>
    <span style="color: #0000FF;">return</span> g0 * RT_m**2 / (RT_m + z)**2

<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">on pourra v&#233;rfier que cela n'a pas d'incidence ...</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Calcul du champ de pression par la m&#233;thode d&#8217;Euler</span>
<span style="color: #BA36A5;">Patm</span> = [P0] <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Initialisation</span>
<span style="color: #0000FF;">for</span> k <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">range</span>(N - 1): <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Il reste N - 1 termes &#224; calculer</span>
    <span style="color: #BA36A5;">zval</span> = zatm[k]
<span style="color: #8D8D84;">#    </span><span style="color: #8D8D84; font-style: italic;">print(zval)</span>
    Patm.append( Patm[k] - M * g2(zval) * Patm[k] * dz /(R*T(zval, <span style="color: #008000;">'K'</span>)))

    
    <span style="color: #006FE0;">print</span>(k,RT_m,dz,zval,Patm[k])


    
<span style="color: #8D8D84;">#    </span><span style="color: #8D8D84; font-style: italic;">print(g1(zval))</span>
<span style="color: #BA36A5;">Patm</span> = np.array(Patm) <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Conversion de la liste en tableau</span>
</pre>
</div>

<p>
0 6400000.0 1010.10101010101 0.0 100000.0
1 6400000.0 1010.10101010101 1010.10101010101 88005.1349164867
2 6400000.0 1010.10101010101 2020.20202020202 77202.30348704716
3 6400000.0 1010.10101010101 3030.30303030303 67498.58867610412
4 6400000.0 1010.10101010101 4040.40404040404 58806.25104339166
5 6400000.0 1010.10101010101 5050.50505050505 51042.55789155615
6 6400000.0 1010.10101010101 6060.60606060606 44130.16265700278
7 6400000.0 1010.10101010101 7070.707070707071 38005.1460426288
8 6400000.0 1010.10101010101 8080.80808080808 32595.53713031624
9 6400000.0 1010.10101010101 9090.90909090909 27834.255130538837
10 6400000.0 1010.10101010101 10101.0101010101 23658.89555558609
11 6400000.0 1010.10101010101 11111.111111111111 20015.968404858853
12 6400000.0 1010.10101010101 12121.21212121212 16885.4530632168
13 6400000.0 1010.10101010101 13131.31313131313 14207.53465714382
14 6400000.0 1010.10101010101 14141.414141414141 11955.025690379252
15 6400000.0 1010.10101010101 15151.51515151515 10060.233780991892
16 6400000.0 1010.10101010101 16161.61616161616 8466.255843087163
17 6400000.0 1010.10101010101 17171.71717171717 7125.2555646246865
18 6400000.0 1010.10101010101 18181.81818181818 5997.016341538385
19 6400000.0 1010.10101010101 19191.91919191919 5047.7255462221665
20 6400000.0 1010.10101010101 20202.0202020202 4248.953087383648
21 6400000.0 1010.10101010101 21212.121212121212 3577.4183374180107
22 6400000.0 1010.10101010101 22222.222222222223 3014.8119904782475
23 6400000.0 1010.10101010101 23232.32323232323 2543.0175670256044
24 6400000.0 1010.10101010101 24242.42424242424 2147.005114456985
25 6400000.0 1010.10101010101 25252.52525252525 1814.2929868643687
26 6400000.0 1010.10101010101 26262.62626262626 1534.5056085271328
27 6400000.0 1010.10101010101 27272.727272727272 1299.0097283739196
28 6400000.0 1010.10101010101 28282.828282828283 1100.6149282986885
29 6400000.0 1010.10101010101 29292.92929292929 933.3267854948461
30 6400000.0 1010.10101010101 30303.0303030303 792.143227671052
31 6400000.0 1010.10101010101 31313.13131313131 673.0134111320374
32 6400000.0 1010.10101010101 32323.23232323232 572.633306097543
33 6400000.0 1010.10101010101 33333.33333333333 487.92324163965026
34 6400000.0 1010.10101010101 34343.43434343434 416.3301232773807
35 6400000.0 1010.10101010101 35353.53535353535 355.73391609706545
36 6400000.0 1010.10101010101 36363.63636363636 304.46326116547857
37 6400000.0 1010.10101010101 37373.73737373737 261.1495060371151
38 6400000.0 1010.10101010101 38383.83838383838 224.47226057515786
39 6400000.0 1010.10101010101 39393.93939393939 193.3440438907779
40 6400000.0 1010.10101010101 40404.0404040404 166.86683135233088
41 6400000.0 1010.10101010101 41414.14141414141 144.28990537425256
42 6400000.0 1010.10101010101 42424.242424242424 124.99023263741617
43 6400000.0 1010.10101010101 43434.343434343435 108.46061734382907
44 6400000.0 1010.10101010101 44444.444444444445 94.27710744975224
45 6400000.0 1010.10101010101 45454.54545454545 82.08457164272464
46 6400000.0 1010.10101010101 46464.64646464646 71.57054546378708
47 6400000.0 1010.10101010101 47474.74747474747 62.47520999973315
48 6400000.0 1010.10101010101 48484.84848484848 54.59761391906603
49 6400000.0 1010.10101010101 49494.94949494949 47.74215065509645
50 6400000.0 1010.10101010101 50505.0505050505 41.74936040896459
51 6400000.0 1010.10101010101 51515.15151515151 36.51045086781621
52 6400000.0 1010.10101010101 52525.25252525252 31.930379289828064
53 6400000.0 1010.10101010101 53535.35353535353 27.91313398708749
54 6400000.0 1010.10101010101 54545.454545454544 24.380390998737745
55 6400000.0 1010.10101010101 55555.555555555555 21.276257572951522
56 6400000.0 1010.10101010101 56565.656565656565 18.54908855180122
57 6400000.0 1010.10101010101 57575.757575757576 16.153962477990678
58 6400000.0 1010.10101010101 58585.85858585858 14.052606959650243
59 6400000.0 1010.10101010101 59595.95959595959 12.210910314448236
60 6400000.0 1010.10101010101 60606.0606060606 10.598496720439364
61 6400000.0 1010.10101010101 61616.16161616161 9.184305221619816
62 6400000.0 1010.10101010101 62626.26262626262 7.943409480161715
63 6400000.0 1010.10101010101 63636.36363636363 6.856500646586492
64 6400000.0 1010.10101010101 64646.46464646464 5.9062024302604605
65 6400000.0 1010.10101010101 65656.56565656565 5.076899955882727
66 6400000.0 1010.10101010101 66666.66666666666 4.352582769413613
67 6400000.0 1010.10101010101 67676.76767676767 3.720494151208412
68 6400000.0 1010.10101010101 68686.86868686868 3.1703502163572543
69 6400000.0 1010.10101010101 69696.9696969697 2.6928460880421654
70 6400000.0 1010.10101010101 70707.0707070707 2.279579088722883
71 6400000.0 1010.10101010101 71717.17171717172 1.9252957963853574
72 6400000.0 1010.10101010101 72727.27272727272 1.623078653354077
73 6400000.0 1010.10101010101 73737.37373737374 1.365723334290827
74 6400000.0 1010.10101010101 74747.47474747474 1.1469594845082371
75 6400000.0 1010.10101010101 75757.57575757576 0.9613379121355667
76 6400000.0 1010.10101010101 76767.67676767676 0.8037833054792682
77 6400000.0 1010.10101010101 77777.77777777777 0.670257233695635
78 6400000.0 1010.10101010101 78787.87878787878 0.5573751688131706
79 6400000.0 1010.10101010101 79797.97979797979 0.4621889481316378
80 6400000.0 1010.10101010101 80808.0808080808 0.3821358317067111
81 6400000.0 1010.10101010101 81818.18181818181 0.315288688823679
82 6400000.0 1010.10101010101 82828.28282828283 0.2596415613485533
83 6400000.0 1010.10101010101 83838.38383838383 0.21340184758516223
84 6400000.0 1010.10101010101 84848.48484848485 0.17505023259746716
85 6400000.0 1010.10101010101 85858.58585858585 0.1435532303182595
86 6400000.0 1010.10101010101 86868.68686868687 0.1177315669098593
87 6400000.0 1010.10101010101 87878.78787878787 0.09656117452684332
88 6400000.0 1010.10101010101 88888.88888888889 0.07920303074194138
89 6400000.0 1010.10101010101 89898.9898989899 0.06496967442182246
90 6400000.0 1010.10101010101 90909.0909090909 0.0532977890903985
91 6400000.0 1010.10101010101 91919.19191919192 0.0437257527816615
92 6400000.0 1010.10101010101 92929.29292929292 0.03587525344864476
93 6400000.0 1010.10101010101 93939.39393939394 0.02948912555594218
94 6400000.0 1010.10101010101 94949.49494949494 0.02428786124653674
95 6400000.0 1010.10101010101 95959.59595959596 0.020042890198325967
96 6400000.0 1010.10101010101 96969.69696969696 0.016573678869528607
97 6400000.0 1010.10101010101 97979.79797979798 0.01373250824740759
98 6400000.0 1010.10101010101 98989.89898989898 0.01140080208874268
</p>


<p>
On réalise ensuite le graphe du champ de pression en fonction de \(z\). C'est une intégration "facile" mais coûteuse : on peut vérifier que la précision augmente avec \(N\) au prix d'un temps de calcul considérablemetn accru &#x2026;
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #006FE0;">print</span>(zatm[99]/1e3)
<span style="color: #006FE0;">print</span>(Patm[50])
</pre>
</div>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #BA36A5;">fig</span>, <span style="color: #BA36A5;">ax</span> = plt.subplots()
ax.plot( Patm,zatm)
plt.savefig(<span style="color: #008000;">"graph_Q7.png"</span>)
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/f0365e7ea7faf2311103bc0a9939ba4135ed38f0.png" alt="f0365e7ea7faf2311103bc0a9939ba4135ed38f0.png" />
</p>
</div>

<p>
Remarque : il pourrait être intéressant de réaliser une petite étude de "scaling" pour mesurer la dépendance du temps de calcul avec \(N\) &#x2026;
</p>
</div>
</div>

<div id="outline-container-org5cb740e" class="outline-3">
<h3 id="org5cb740e">Q.08 - calcul de la masse totale de l'atmosphère&#xa0;&#xa0;&#xa0;<span class="tag"><span class="CODE">CODE</span></span></h3>
<div class="outline-text-3" id="text-org5cb740e">
<p>
On exprime la masse d’air contenue dans le volume élémentaire d’atmosphère d
situé entre les sphères d’altitudes \(z\) et \(z + dz\) tel que : 
</p>

<p>
\[ d \tau = 4 \pi (R_T + z )^2 dz \]
</p>

<p>
Ensuite, puisque \(dm = \rho d \tau\), on obtient en remplaçant par la formule de la masse volumique trouvée plus haut : 
</p>


<p>
\[ m(z) = {\int}_0^z 4 \pi (R_T + z )^2  \frac{M p(z)}{R T(z)} dz\] 
</p>

<p>
Voici, un exemple de code Python pour calculer cette intégrale par la méthode des rectangles : 
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Calcul de la masse d&#8217;air jusqu&#8217;&#224; l&#8217;altitude z</span>
<span style="color: #0000FF;">def</span> <span style="color: #006699;">masse_atm</span>(z):
    <span style="color: #BA36A5;">masse</span> = 0
    <span style="color: #BA36A5;">k</span> = 0
    <span style="color: #0000FF;">while</span> zatm[k] &lt; <span style="color: #BA36A5;">z</span>: <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">On arr&#234;te le calcul &#224; l&#8217;altitude z</span>
        dm = 4*np.pi*(RT_m+zatm[k])**2*M*Patm[k]/(R*T(zatm[k], <span style="color: #008000;">'K'</span>)) * dz
        <span style="color: #BA36A5;">masse</span> = masse + dm
        <span style="color: #BA36A5;">k</span> = k + 1
    <span style="color: #0000FF;">return</span> masse
</pre>
</div>

<p>
On a supposé le champ de pensanteur uniforme.
</p>

<p>
Inclure une question sur la variation relative de g avec z
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">evaluation de la fonction masse</span>
<span style="color: #BA36A5;">mtot</span> = masse_atm(100e3) <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Masse d'air dans l'atmosph&#232;re terrestre</span>
<span style="color: #006FE0;">print</span>(<span style="color: #008000;">'Masse de l\'atmosph&#232;re :'</span>, mtot, <span style="color: #008000;">'kg'</span>)
</pre>
</div>

<p>
Masse de l'atmosphère : 5.273391114020367e+18 kg
Masse de l'atmosphère : 5.273391114020367e+18 kg
Masse de l'atmosphère : 5.26276756718815e+18 kg
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">evaluation de la fonction masse</span>
<span style="color: #BA36A5;">mtropo</span> = masse_atm(5e3) <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Masse d'air dans la troposph&#232;re</span>
<span style="color: #006FE0;">print</span>(<span style="color: #008000;">'Proportion d\'air dans la troposph&#232;re :'</span>, mtropo/mtot)
</pre>
</div>
</div>
</div>



<div id="outline-container-org09374c8" class="outline-3">
<h3 id="org09374c8">Q.09&#xa0;&#xa0;&#xa0;<span class="tag"><span class="TABLEAU">TABLEAU</span></span></h3>
<div class="outline-text-3" id="text-org09374c8">
<div class="org-src-container">
<pre class="src src-jupyter-python">(g1(10)-g1(0))/g1(0)
</pre>
</div>

<p>
On recalcule la pression en supposant \(g\) uniforme : 
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #BA36A5;">Patm2</span> = [P0]
<span style="color: #0000FF;">for</span> k <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">range</span>(N - 1):
    Patm2.append(Patm2[k] - M*g0*Patm2[k]*dz/(R*T(zatm[k], <span style="color: #008000;">'K'</span>)))
<span style="color: #BA36A5;">Patm2</span> = np.array(Patm2)
<span style="color: #BA36A5;">ecart1</span> = 100 * <span style="color: #006FE0;">abs</span>(Patm - Patm2) / Patm <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Ecart relatif</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #BA36A5;">fig</span>, <span style="color: #BA36A5;">ax</span> = plt.subplots()
ax.plot( ecart1,zatm)
plt.savefig(<span style="color: #008000;">"graph_Q9.png"</span>)
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/d14a95cd682907201ffefe8d8987a9a30ea2044c.png" alt="d14a95cd682907201ffefe8d8987a9a30ea2044c.png" />
</p>
</div>
</div>
</div>



<div id="outline-container-orge0971b4" class="outline-3">
<h3 id="orge0971b4">Q.10&#xa0;&#xa0;&#xa0;<span class="tag"><span class="CODE">CODE</span></span></h3>
<div class="outline-text-3" id="text-orge0971b4">
<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #BA36A5;">Piso</span> = [P0]
<span style="color: #0000FF;">for</span> k <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">range</span>(N - 1):
    Piso.append(Piso[k] - M*g0*Piso[k]*dz/(R*T(0, <span style="color: #008000;">'K'</span>)))
<span style="color: #BA36A5;">Piso</span> = np.array(Piso)
<span style="color: #BA36A5;">ecart2</span> = 100 * <span style="color: #006FE0;">abs</span>(Piso - Patm) / Patm <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Ecart relatif</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #BA36A5;">fig</span>, <span style="color: #BA36A5;">ax</span> = plt.subplots()
ax.plot( ecart2,zatm)
plt.savefig(<span style="color: #008000;">"graph_Q10.png"</span>)
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/f075d877e5e5013d71e97ad2f82313a895a6e103.png" alt="f075d877e5e5013d71e97ad2f82313a895a6e103.png" />
</p>
</div>
</div>
</div>


<div id="outline-container-org59cd630" class="outline-3">
<h3 id="org59cd630">Q.11&#xa0;&#xa0;&#xa0;<span class="tag"><span class="TABLEAU">TABLEAU</span></span></h3>
<div class="outline-text-3" id="text-org59cd630">
<p>
Le champ de pression satisfait l'équation différentielle simplifiée (cas isotherme) : 
$
</p>

<p>
\[ \frac{dP}{dz} + \frac{M g_0}{R T_0} p(z) = 0\] 
</p>

<p>
Cette équation s'intègre classiquement ainsi en posant \(H = RT/Mg\) : 
</p>

<p>
\[ p(z) = P_0 e^{-z/H}\]
</p>

<p>
<b>Note</b> : Je vous laisse le soin de réaliser l'application numérique que nous vérifierons au prochain debrief.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #BA36A5;">H</span> = R*T(0,<span style="color: #008000;">'K'</span>)/(M*g0)
<span style="color: #006FE0;">print</span>(H)
</pre>
</div>

<p>
Application numérique : 
</p>

<p>
\[ H = \]
</p>
</div>
</div>

<div id="outline-container-org618a61a" class="outline-3">
<h3 id="org618a61a">Q.12&#xa0;&#xa0;&#xa0;<span class="tag"><span class="CODE">CODE</span></span></h3>
<div class="outline-text-3" id="text-org618a61a">
<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #BA36A5;">ztropo</span>, <span style="color: #BA36A5;">Ttropo</span> = [], [] <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Initialisation des listes</span>
<span style="color: #BA36A5;">k</span> = 0
<span style="color: #0000FF;">while</span> zatm[k] &lt; 10<span style="color: #BA36A5;">e3</span>: <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">On s&#233;lectionne les donn&#233;es jusqu&#8217;&#224; 10km</span>
    ztropo.append(zatm[k])
    Ttropo.append(T(zatm[k], <span style="color: #008000;">'K'</span>))
    k = k + 1 <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">NB&#3;:: On a pris en fait 1 point sur 5 pour le graphe</span>
<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">R&#233;gression lin&#233;aire T(z)=a*z+b</span>
<span style="color: #BA36A5;">a</span>, <span style="color: #BA36A5;">b</span> = np.polyfit(ztropo, Ttropo, 1) <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Calcul de la r&#233;gression lin&#233;aire</span>
<span style="color: #BA36A5;">Tlin</span> = [a*z + b <span style="color: #0000FF;">for</span> z <span style="color: #0000FF;">in</span> ztropo] <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Mod&#232;le lin&#233;aire de la temp&#233;rature</span>


<span style="color: #006FE0;">print</span>(a,b)
</pre>
</div>

<p>
-0.006427272727272727 287.62901744719915
-0.006402700270027003 287.5138802168507
</p>


<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #BA36A5;">Pgradient</span> = [P0]
<span style="color: #0000FF;">for</span> k <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">range</span>(<span style="color: #006FE0;">len</span>(ztropo) - 1):
    Pgradient.append(Pgradient[k] - M*g0*Pgradient[k]*dz/(R*(a*zatm[k] + b)))
<span style="color: #BA36A5;">Pgradient</span> = np.array(Pgradient)
<span style="color: #BA36A5;">ecart3</span> = 100 * <span style="color: #006FE0;">abs</span>(Pgradient - Patm) / Patm
</pre>
</div>


<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #BA36A5;">fig</span>, <span style="color: #BA36A5;">ax</span> = plt.subplots()
ax.plot( ecart3,zatm)
plt.savefig(<span style="color: #008000;">"graph_Q12.png"</span>)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #BA36A5;">fig</span>, <span style="color: #BA36A5;">ax</span> = plt.subplots()
ax.plot( Patm,zatm)
ax.plot( Patm2,zatm)
plt.savefig(<span style="color: #008000;">"graph_Q13.png"</span>)
</pre>
</div>

<p>
<iframe width="440" height="335" src="https://www.youtube.com/embed/A3JAlWM8qRM" frameborder="0" allowfullscreen></iframe>
</p>
</div>
</div>
</div>

<div id="outline-container-orgedef26b" class="outline-2">
<h2 id="orgedef26b"><span class="section-number-2">3</span> Exercice Formation d'un nuage - [ optionnel ]&#xa0;&#xa0;&#xa0;<span class="tag"><span class="BONUS">BONUS</span></span></h2>
<div class="outline-text-2" id="text-3">
<p>
<b>Remarque</b> : Cet exercice était initialement prévu pour constituer un devoir maison. Nous avons décidé de ne l'évaluer cette année en raison de la charge de travail due aux rapports de TP.
</p>


<p>
On souhaite expliquer la formation d'un nuage d'une manière simplifiée en envisageant les mécanismes thermodynamiques responsables du phénomène. Ici nous faisons l'hypothèse que l'apparition d'un nuage est d'abord conditionnée par un déplacement adiabatique de masses d’air. \footnote{On ommet volontairement certains phénomènes subtiles de nucléation dans cette première approche.}
</p>

<p>
Cet exercice vous propose tout d'abord d'étudier la physique responsable de la création d’un courant ascendant pouvant conduire à la formation d'un nuage sous certaines conditions.
</p>

<p>
Un point de l'atmosphère est repéré par ses coordonnées cartésiennes (Oxyz), tel que l'axe (Oz) coïncide avec la verticale ascendante avec \(z=0\) pris au niveau de la mer. Par comodité, nous garderons les notations et valeurs numériques des constantes physiques utilisées pour le TP.
</p>
</div>

<div id="outline-container-orgce20ae1" class="outline-3">
<h3 id="orgce20ae1"><span class="section-number-3">3.1</span> En l'abscence de mouvement (équilibre)</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Des relevés expérimentaux montrent qu'en l'absence de mouvement de l'air, la température est fonction de l'altitude \(z\) suivant une loi affine : 
</p>

<p>
\[ T(z) = T_{0} - \lambda z \]
</p>

<p>
<b>Q1</b>. (1 pt) Sur quelle intervalle de z cette approximation est-elle valable ?
</p>

<p>
Avec les hypothèse thermodynamiques faites en début d'exercice, on peut montrer que \(P\) et \(T\) sont liées par une relation de la forme : 
</p>

<p>
\[ T =T_0 \left( \frac{P}{P_0}  \right)^{q} \]
</p>

<p>
<b>Q2</b>. (2 pt) Réaliser à nouveau la démonstration de cette relation.
</p>

<p>
<b>Q3</b>. (1 pt) Déterminer l’exposant \(q\) qui s'exprime uniquement en fonction de \(M\), \(g_0\), \(\lambda\) et \(R\). Faites l'application numérique pour une valeur convenablement choisie de \(\lambda\).
</p>
</div>
</div>


<div id="outline-container-org121618d" class="outline-3">
<h3 id="org121618d"><span class="section-number-3">3.2</span> Apparition d'un mouvement (instabilté)</h3>
<div class="outline-text-3" id="text-3-2">
<p>
L'état d'équilibre précédent est réalisé lorsque les isothermes (niveaux où \(T=Cte\)) et les isobares (\(P=Cte\)) coïncident avec les équipotentielles du champ de pesanteur (\(z = cte\))\footnote{les spécialistes parlent de configurations barotropes et baroclines}. En présence d’hétérogénéités de température au niveau du sol, l'air s'échauffe différemment et peut se mettre en mouvement, c'est un phénomène bien connu ! 
</p>

<p>
\bigskip
</p>


<div class="figure">
<p><img src="./Ex2a.png" alt="Ex2a.png" />
</p>
</div>

<p>
On se place à l'altitude \(z\) à la verticale du point \(Q\) et on suppose que l'air est localement plus chaud que l'air avoisinant. Tout se passe comme si une poche de gaz était limitée par une enveloppe souple et non tendue. On convient des hypothèses et notations suivantes : 
</p>

<ul class="org-ul">
<li>La bulle de gaz évolue sans échanger de matière ni de chaleur avec l'extérieur.</li>

<li>La <b>pression de la bulle</b> reste égale à celle de l'air environnant à la même altitude.</li>

<li>La <b>température de l'air</b> environnant varie toujours linéairement avec la température.</li>

<li>On note \(P_B\), \(T_B\) et \(\rho_B\) la pression, la température et la masse volumique du gaz emprisonné dans la bulle. On note \(T_A\) et \(\rho_A\) la température et la masse volumique de l'air environnant à la même altitude.</li>
</ul>

<p>
<b>Q4</b>. (2 pt) Montrer que la bulle s'élève si \(T_B > T_A\).
</p>

<p>
Les questions suivantes nécéssitent la manipulation de quelques relations de thermodynamique. Le gaz emprisonné dans la bulle subit une transformation dite <b>adiabatique</b>. De plus, comme souvent en thermo on supposera la transformation <b>réversible</b> (ce n'est pas rigouresuememnt vrai  mais c'est plus facile à résoudre ainsi).
</p>

<p>
Appellons \(T_1\) la température du gaz dans la bulle à l'altitude de sa formation \(z_1\) et \(P_1\) la pression correspondante.
</p>

<p>
<b>Q5</b>. (2 pt) En retrouvant une des 3 formes de l'expression de la <b>loi de Laplace</b> pour les gaz parfaits, exprimer \(T_B\) en fonction de \(T_1\), \(P_1\) et \(P_B\). En cas de difficulté, n'hésitez pas à consulter des ressources sur ce sujet pour cette question théorique (reformulez et citez vos sources). 
</p>

<p>
<b>Q6</b>. (2 pt) On veut démontrer qu'il existe une altitude plafond \({z^{\star}\) pour l'ascension de la bulle. On note \(T^{\star}\) et \(P^{\star}\) la température et la pression de la bulle lorsqu'elle arrive à cette altitude. Evaluer numériquement \(T^{\star}\) et \(P^{\star}\) pour \(T_1 = 280 K\) et \(z_1 = 2 km\). En déduire la valeur de l'altitude plafond \(z^{\star}\) à laquelle se stabilise la bulle.
</p>

<p>
Pour cette question, on vous demande de rédiger soigneusement une explication du phénomène de stabilisation de la bulle d'air.
</p>
</div>
</div>


<div id="outline-container-orgaeb8859" class="outline-3">
<h3 id="orgaeb8859"><span class="section-number-3">3.3</span> Explication qualitative de la formation d'un nuage.</h3>
<div class="outline-text-3" id="text-3-3">
<p>
<b>Q7</b> (5 pt) Nous faisions l'hypothèse d'un air sec dans la partie précédente. Maintenant nous envisageons une parcelle d'air <i>humide</i> (air sec + vapeur d'eau). 
</p>

<ol class="org-ol">
<li>Proposer une explication qualitative de la possibilité de formation d'un nuage au cours de l'ascension d'une bulle.</li>

<li>Réaliser un schéma légendé, si possible au format A3 \footnote{2 feuilles A4 accolées feront l'affaire}, présentant une illustration vulgarisée de la formation d'un nuage telle qu'on peut la comprendre <b>d'après le mécanisme illustré par cet exercice</b>.</li>

<li>Au besoin, ajouter quelques détails supplémentaire (avec une autre couleur) signalant d'autres phénomènes pouvant rentrer en jeu dans le mécanisme de formation d'un nuage.</li>
</ol>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2023-02-01 mer. 00:00</p>
<p class="author">Author: Thomas Lebrat</p>
<p class="date">Created: 2023-02-28 mar. 11:45</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
